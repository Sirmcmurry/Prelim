df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
library(tidyverse)
library(ggplot2)
library(MASS)
library(dplyr)
library(ggrepel)
lda_data = readxl::read_excel("C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\data.xlsx")
lda_data=lda_data[lda_data$vowel!="i",]
lda_model <- lda(vowel_ethnicity ~ f11 + f21 + f31 + f15 + f25 + f35,
data = lda_data)
predictions <- predict(lda_model)
view(predictions)
confusion_matrix <- table(lda_data$vowel_ethnicity, predictions$class)
df_actual <- lda_data %>%
group_by(vowel_ethnicity) %>%
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Actual"
)
# Compute predicted vowel-ethnicity averages
df_predicted <- lda_data %>%
group_by(predicted_ethnicity, vowel) %>%  # Need vowel for clarity in grouping
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Predicted"
)
# Combine both sets into one dataset
df_plot01 <- bind_rows(df_actual, df_predicted)
df_plot_clean <- df_plot01 %>%
filter(!is.na(vowel), !is.na(predicted_ethnicity))
ggplot(df_plot_clean, aes(x = f2_avg, y = f1_avg, color = vowel, shape = predicted_ethnicity)) +
geom_point(size = 4, alpha = 0.8) +
geom_text_repel(aes(label = vowel), size = 5, fontface = "bold") +
scale_y_reverse() +
scale_x_reverse() +
theme_classic() +
labs(
title = "",
x = "F2 (Hz)",
y = "F1 (Hz)",
color = "Vowel",
shape = "Predicted Ethnicity"
) +
theme(
legend.position = "bottom",
axis.title = element_text(size = 14, face = "bold"),
axis.text = element_text(size = 12)
)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
View(df_sdt)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
df_sdt <- df_sdt %>%
mutate(
d_prime = qnorm(hit_rate) - qnorm(false_alarm_rate)
)
df_sdt <- df_sdt %>%
mutate(
response_bias = -0.5 * (qnorm(hit_rate) + qnorm(false_alarm_rate))
)
library(pROC)
# Define the vowel you want to analyze
target_vowel01 = "eɪ_EA"  # Change this dynamically
target_vowel02 = "eɪ_W"
target_vowel03 = "ɛ_EA"
target_vowel04 = "ɛ_W"
target_vowel05 = "ɪ_EA"
target_vowel06 = "ɪ_W"
target_vowel07 = "u_EA"
target_vowel08 = "u_W"
target_vowel09 = "ʊ_EA"
target_vowel10 = "ʊ_W"
library(tidyverse)
library(ggplot2)
library(MASS)
library(dplyr)
library(ggrepel)
library(pROC)
lda_data = readxl::read_excel("C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\data.xlsx")
lda_data=lda_data[lda_data$vowel!="i",]
lda_model <- lda(vowel_ethnicity ~ f11 + f21 + f31 + f15 + f25 + f35,
data = lda_data)
predictions <- predict(lda_model)
view(predictions)
confusion_matrix <- table(lda_data$vowel_ethnicity, predictions$class)
df_actual <- lda_data %>%
group_by(vowel_ethnicity) %>%
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Actual"
)
# Compute predicted vowel-ethnicity averages
df_predicted <- lda_data %>%
group_by(predicted_ethnicity, vowel) %>%  # Need vowel for clarity in grouping
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Predicted"
)
# Combine both sets into one dataset
df_plot01 <- bind_rows(df_actual, df_predicted)
df_plot_clean <- df_plot01 %>%
filter(!is.na(vowel), !is.na(predicted_ethnicity))
ggplot(df_plot_clean, aes(x = f2_avg, y = f1_avg, color = vowel, shape = predicted_ethnicity)) +
geom_point(size = 4, alpha = 0.8) +
geom_text_repel(aes(label = vowel), size = 5, fontface = "bold") +
scale_y_reverse() +
scale_x_reverse() +
theme_classic() +
labs(
title = "",
x = "F2 (Hz)",
y = "F1 (Hz)",
color = "Vowel",
shape = "Predicted Ethnicity"
) +
theme(
legend.position = "bottom",
axis.title = element_text(size = 14, face = "bold"),
axis.text = element_text(size = 12)
)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
df_sdt <- df_sdt %>%
mutate(
d_prime = qnorm(hit_rate) - qnorm(false_alarm_rate)
)
df_sdt <- df_sdt %>%
mutate(
response_bias = -0.5 * (qnorm(hit_rate) + qnorm(false_alarm_rate))
)
# Define the vowel you want to analyze
target_vowel01 = "eɪ_EA"  # Change this dynamically
target_vowel02 = "eɪ_W"
target_vowel03 = "ɛ_EA"
target_vowel04 = "ɛ_W"
target_vowel05 = "ɪ_EA"
target_vowel06 = "ɪ_W"
target_vowel07 = "u_EA"
target_vowel08 = "u_W"
target_vowel09 = "ʊ_EA"
target_vowel10 = "ʊ_W"
df_vowel01 <- df_sdt %>% filter(vowel_ethnicity == target_vowel01)
df_vowel02 <- df_sdt %>% filter(vowel_ethnicity == target_vowel02)
df_vowel03 <- df_sdt %>% filter(vowel_ethnicity == target_vowel03)
df_vowel04 <- df_sdt %>% filter(vowel_ethnicity == target_vowel04)
df_vowel05 <- df_sdt %>% filter(vowel_ethnicity == target_vowel05)
df_vowel06 <- df_sdt %>% filter(vowel_ethnicity == target_vowel06)
df_vowel07 <- df_sdt %>% filter(vowel_ethnicity == target_vowel07)
df_vowel08 <- df_sdt %>% filter(vowel_ethnicity == target_vowel08)
df_vowel09 <- df_sdt %>% filter(vowel_ethnicity == target_vowel09)
df_vowel10 <- df_sdt %>% filter(vowel_ethnicity == target_vowel10)
View(df_vowel01)
roc_curve01 <- roc(response = df_vowel01$hit_rate, predictor = df_vowel01$d_prime)
df_vowel01 <- df_vowel01 %>%
filter(vowel_ethnicity == "eɪ_EA") %>%  # Replace "IH_EA" with desired vowel
mutate(
binary_hit = ifelse(hit_rate >= 0.5, 1, 0)  # Convert hit rate to binary classification
)
roc_curve01 <- roc(response = df_vowel01$hit_rate, predictor = df_vowel01$d_prime)
df_vowel01 <- df_sdt %>%
filter(vowel_ethnicity == "eɪ_EA") %>%  # Replace "IH_EA" with desired vowel
mutate(
binary_hit = ifelse(hit_rate >= 0.5, 1, 0)  # Convert hit rate to binary classification
)
roc_curve01 <- roc(response = df_vowel01$hit_rate, predictor = df_vowel01$d_prime)
View(df_vowel01)
View(df_vowel01)
df_vowel01 <- df_sdt %>%
filter(vowel_ethnicity == "eɪ_EA") %>%  # Replace "IH_EA" with desired vowel
mutate(
binary_hit = ifelse(hit_rate >= 0.5, 1, 0)  # Convert hit rate to binary classification
)
roc_curve01 <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
df_vowel01 <- df_sdt %>%
filter(vowel_ethnicity == "eɪ_EA") %>%  # Replace "IH_EA" with desired vowel
mutate(
binary_hit = ifelse(hit_rate >= median(hit_rate), 1, 0)  # Convert hit rate to binary classification
)
roc_curve01 <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
View(df_vowel01)
df_vowel01 <- df_sdt %>% filter(vowel_ethnicity == target_vowel01)
df_vowel02 <- df_sdt %>% filter(vowel_ethnicity == target_vowel02)
df_vowel03 <- df_sdt %>% filter(vowel_ethnicity == target_vowel03)
df_vowel04 <- df_sdt %>% filter(vowel_ethnicity == target_vowel04)
df_vowel05 <- df_sdt %>% filter(vowel_ethnicity == target_vowel05)
df_vowel06 <- df_sdt %>% filter(vowel_ethnicity == target_vowel06)
df_vowel07 <- df_sdt %>% filter(vowel_ethnicity == target_vowel07)
df_vowel08 <- df_sdt %>% filter(vowel_ethnicity == target_vowel08)
df_vowel09 <- df_sdt %>% filter(vowel_ethnicity == target_vowel09)
df_vowel10 <- df_sdt %>% filter(vowel_ethnicity == target_vowel10)
View(df_vowel01)
df_vowel01=df_sdt %>%
filter(vowel_ethnicity == "eɪ_EA") %>%
mutate(
binary_hit = ifelse(hit_rate >= 0.5, 1, 0)
)
View(df_vowel01)
roc_curve <- roc(response = df_vowel$binary_hit, predictor = df_vowel$d_prime)
roc_curve <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
df_vowel01 <- df_vowel01 %>%
mutate(binary_hit = ifelse(hit_rate >= quantile(hit_rate, 0.5), 1, 0))  # Use a median cutoff
View(df_vowel01)
roc_curve <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
df_vowel01 <- df_vowel01 %>%
mutate(binary_hit = ifelse(hit_rate >= quantile(hit_rate, 0.5), 1, 0))
df_vowel01 <- df_vowel01 %>%
mutate(miss = 1 - binary_hit)  # Converts hits (1) into misses (0) and vice versa
roc_curve <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
View(df_vowel01)
roc_curve <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
df_vowel01 <- df_vowel01 %>%
mutate(binary_hit = ifelse(hit_rate >= quantile(hit_rate, 0.75), 1, 0))
df_vowel01 <- df_vowel01 %>%
mutate(miss = 1 - binary_hit)  # Converts hits (1) into misses (0) and vice versa
roc_curve <- roc(response = df_vowel01$binary_hit, predictor = df_vowel01$d_prime)
View(df_vowel01)
View(df_vowel01)
View(df_predicted)
View(df_actual)
View(df_plot_clean)
View(df_plot01)
View(df_predicted)
View(df_sdt)
library(tidyverse)
library(ggplot2)
library(MASS)
library(dplyr)
library(ggrepel)
lda_data = readxl::read_excel("C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\data.xlsx")
lda_data=lda_data[lda_data$vowel!="i",]
lda_model <- lda(vowel_ethnicity ~ f11 + f21 + f31 + f15 + f25 + f35,
data = lda_data)
predictions <- predict(lda_model)
view(predictions)
confusion_matrix <- table(lda_data$vowel_ethnicity, predictions$class)
df_actual <- lda_data %>%
group_by(vowel_ethnicity) %>%
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Actual"
)
# Compute predicted vowel-ethnicity averages
df_predicted <- lda_data %>%
group_by(predicted_ethnicity, vowel) %>%  # Need vowel for clarity in grouping
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Predicted"
)
# Combine both sets into one dataset
df_plot01 <- bind_rows(df_actual, df_predicted)
df_plot_clean <- df_plot01 %>%
filter(!is.na(vowel), !is.na(predicted_ethnicity))
ggplot(df_plot_clean, aes(x = f2_avg, y = f1_avg, color = vowel, shape = predicted_ethnicity)) +
geom_point(size = 4, alpha = 0.8) +
geom_text_repel(aes(label = vowel), size = 5, fontface = "bold") +
scale_y_reverse() +
scale_x_reverse() +
theme_classic() +
labs(
title = "",
x = "F2 (Hz)",
y = "F1 (Hz)",
color = "Vowel",
shape = "Predicted Ethnicity"
) +
theme(
legend.position = "bottom",
axis.title = element_text(size = 14, face = "bold"),
axis.text = element_text(size = 12)
)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
df_sdt <- df_sdt %>%
mutate(
d_prime = qnorm(hit_rate) - qnorm(false_alarm_rate)
)
df_sdt <- df_sdt %>%
mutate(
response_bias = -0.5 * (qnorm(hit_rate) + qnorm(false_alarm_rate))
)
library(pROC)
View(df_sdt)
write.csv(df_sdt, "C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\df_sdt.csv", row.names = FALSE)
data <- data.frame(
vowel_ethnicity = c("eɪ_EA", "eɪ_W", "o_EA", "o_W", "u_EA", "u_W",
"æ_EA", "æ_W", "ɑ_EA", "ɑ_W", "ɔ_EA", "ɔ_W", "ɔɪ_EA", "ɔɪ_W",
"ɛ_EA", "ɛ_W", "ʌ_EA", "ʌ_W", "ɪ_EA", "ɪ_W", "ʊ_EA", "ʊ_W",
"œ_EA", "œ_W"),
hit_rate = c(0.7778, 0.4667, 0.8, 0.5763, 0.6458, 0.6125,
0.875, 0.5667, 0.88, 0.65, 0.8125, 0.5610, 0.8403, 0.6116,
0.7845, 0.5305, 0.6620, 0.6, 0.7924, 0.5335, 0.8261, 0.5,
0.8264, 0.62),
false_alarm_rate = c(0.2222, 0.5333, 0.2, 0.4237, 0.3542, 0.3875,
0.125, 0.4333, 0.12, 0.35, 0.1875, 0.4390, 0.1597, 0.3884,
0.2155, 0.4695, 0.3380, 0.4, 0.2076, 0.4665, 0.1739, 0.5,
0.1736, 0.38)
)
data <- data.frame(
vowel_ethnicity = c("eɪ_EA", "eɪ_W", "o_EA", "o_W", "u_EA", "u_W",
"æ_EA", "æ_W", "ɑ_EA", "ɑ_W", "ɔ_EA", "ɔ_W", "ɔɪ_EA", "ɔɪ_W",
"ɛ_EA", "ɛ_W", "ʌ_EA", "ʌ_W", "ɪ_EA", "ɪ_W", "ʊ_EA", "ʊ_W",
"œ_EA", "œ_W"),
hit_rate = c(0.7778, 0.4667, 0.8, 0.5763, 0.6458, 0.6125,
0.875, 0.5667, 0.88, 0.65, 0.8125, 0.5610, 0.8403, 0.6116,
0.7845, 0.5305, 0.6620, 0.6, 0.7924, 0.5335, 0.8261, 0.5,
0.8264, 0.62),
false_alarm_rate = c(0.2222, 0.5333, 0.2, 0.4237, 0.3542, 0.3875,
0.125, 0.4333, 0.12, 0.35, 0.1875, 0.4390, 0.1597, 0.3884,
0.2155, 0.4695, 0.3380, 0.4, 0.2076, 0.4665, 0.1739, 0.5,
0.1736, 0.38)
)
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_line() +
geom_point() +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
data <- data.frame(
vowel_ethnicity = c("eɪ_EA", "eɪ_W", "o_EA", "o_W", "u_EA", "u_W",
"æ_EA", "æ_W", "ɑ_EA", "ɑ_W", "ɔ_EA", "ɔ_W", "ɔɪ_EA", "ɔɪ_W",
"ɛ_EA", "ɛ_W", "ʌ_EA", "ʌ_W", "ɪ_EA", "ɪ_W", "ʊ_EA", "ʊ_W",
"œ_EA", "œ_W"),
hit_rate = c(0.7778, 0.4667, 0.8, 0.5763, 0.6458, 0.6125,
0.875, 0.5667, 0.88, 0.65, 0.8125, 0.5610, 0.8403, 0.6116,
0.7845, 0.5305, 0.6620, 0.6, 0.7924, 0.5335, 0.8261, 0.5,
0.8264, 0.62),
false_alarm_rate = c(0.2222, 0.5333, 0.2, 0.4237, 0.3542, 0.3875,
0.125, 0.4333, 0.12, 0.35, 0.1875, 0.4390, 0.1597, 0.3884,
0.2155, 0.4695, 0.3380, 0.4, 0.2076, 0.4665, 0.1739, 0.5,
0.1736, 0.38)
)
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_line() +
geom_point() +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
data = data.frame(
vowel_ethnicity = c("eɪ_EA", "eɪ_W", "u_EA", "u_W", "ɛ_EA", "ɛ_W","ɪ_EA", "ɪ_W", "ʊ_EA", "ʊ_W"),
hit_rate = c(0.7778, 0.4667,0.6458, 0.6125,0.7845, 0.5305,0.7924, 0.5335, 0.8261, 0.5 ),
false_alarm_rate = c(0.2222, 0.5333,0.3542, 0.3875,0.2155, 0.4695,0.2076, 0.4665, 0.1739, 0.5 ))
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_line() +
geom_point() +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_point() +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_point(size=3) +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_point(size=3) +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, group = vowel_ethnicity, color = vowel_ethnicity)) +
geom_line() +
geom_point(size = 3) +
geom_text(aes(label = paste0("d'=", round(d_prime, 2), "\n c=", round(response_bias, 2))),
vjust = -1, size = 3) +  # Adjust label placement and size
labs(title = "ROC Curve with Sensitivity & Response Bias",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
ggplot(df_sdt, aes(x = false_alarm_rate, y = hit_rate, group = vowel_ethnicity, color = vowel_ethnicity)) +
geom_line() +
geom_point(size = 3) +
geom_text(aes(label = paste0("d'=", round(d_prime, 2), "\n c=", round(response_bias, 2))),
vjust = -1, size = 3) +  # Adjust label placement and size
labs(title = "ROC Curve with Sensitivity & Response Bias",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
write_excel_csv(df_sdt, "C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\df_sdt.xlsx")
data = data.frame(
vowel_ethnicity = c("eɪ_EA", "eɪ_W", "u_EA", "u_W", "ɛ_EA", "ɛ_W","ɪ_EA", "ɪ_W", "ʊ_EA", "ʊ_W"),
hit_rate = c(0.7778, 0.4667,0.6458, 0.6125,0.7845, 0.5305,0.7924, 0.5335, 0.8261, 0.5 ),
false_alarm_rate = c(0.2222, 0.5333,0.3542, 0.3875,0.2155, 0.4695,0.2076, 0.4665, 0.1739, 0.5 ))
data <- data[order(data$false_alarm_rate), ]
ggplot(data, aes(x = false_alarm_rate, y = hit_rate, color = vowel_ethnicity)) +
geom_point(size=3) +
labs(title = "ROC Curve for Vowel Classification",
x = "False Alarm Rate",
y = "Hit Rate") +
theme_minimal()
