df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
library(tidyverse)
library(ggplot2)
library(MASS)
library(dplyr)
library(ggrepel)
lda_data = readxl::read_excel("C:\\Users\\verde\\OneDrive\\Desktop\\Prelim\\Prelim\\data.xlsx")
lda_data=lda_data[lda_data$vowel!="i",]
lda_model <- lda(vowel_ethnicity ~ f11 + f21 + f31 + f15 + f25 + f35,
data = lda_data)
predictions <- predict(lda_model)
view(predictions)
confusion_matrix <- table(lda_data$vowel_ethnicity, predictions$class)
df_actual <- lda_data %>%
group_by(vowel_ethnicity) %>%
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Actual"
)
# Compute predicted vowel-ethnicity averages
df_predicted <- lda_data %>%
group_by(predicted_ethnicity, vowel) %>%  # Need vowel for clarity in grouping
summarise(
f1_avg = mean(rowMeans(across(c(f11, f15)), na.rm = TRUE)),
f2_avg = mean(rowMeans(across(c(f21, f25)), na.rm = TRUE)),
type = "Predicted"
)
# Combine both sets into one dataset
df_plot01 <- bind_rows(df_actual, df_predicted)
df_plot_clean <- df_plot01 %>%
filter(!is.na(vowel), !is.na(predicted_ethnicity))
ggplot(df_plot_clean, aes(x = f2_avg, y = f1_avg, color = vowel, shape = predicted_ethnicity)) +
geom_point(size = 4, alpha = 0.8) +
geom_text_repel(aes(label = vowel), size = 5, fontface = "bold") +
scale_y_reverse() +
scale_x_reverse() +
theme_classic() +
labs(
title = "",
x = "F2 (Hz)",
y = "F1 (Hz)",
color = "Vowel",
shape = "Predicted Ethnicity"
) +
theme(
legend.position = "bottom",
axis.title = element_text(size = 14, face = "bold"),
axis.text = element_text(size = 12)
)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
View(df_sdt)
df_sdt <- lda_data %>%
mutate(
hit = ifelse(ethnicity == predicted_ethnicity, 1, 0),
false_alarm = ifelse(ethnicity != predicted_ethnicity, 1, 0)
) %>%
group_by(vowel_ethnicity) %>%
summarise(
hit_rate = mean(hit),
false_alarm_rate = mean(false_alarm),
.groups = "drop"
)
df_sdt <- df_sdt %>%
mutate(
d_prime = qnorm(hit_rate) - qnorm(false_alarm_rate)
)
df_sdt <- df_sdt %>%
mutate(
response_bias = -0.5 * (qnorm(hit_rate) + qnorm(false_alarm_rate))
)
library(pROC)
# Define the vowel you want to analyze
target_vowel01 = "eɪ_EA"  # Change this dynamically
target_vowel02 = "eɪ_W"
target_vowel03 = "ɛ_EA"
target_vowel04 = "ɛ_W"
target_vowel05 = "ɪ_EA"
target_vowel06 = "ɪ_W"
target_vowel07 = "u_EA"
target_vowel08 = "u_W"
target_vowel09 = "ʊ_EA"
target_vowel10 = "ʊ_W"
